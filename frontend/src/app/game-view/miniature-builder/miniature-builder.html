<div [formGroup]="miniatureBuilderForm">

  <section class="teams-row"
  >
    <app-team-select
      [teams]="teams_logos()"
      formControlName="team1"
      label="Team 1"
    ></app-team-select>


    <button (click)="onSwapTeams()" class="swap-btn" matButton="elevated">Swap teams</button>

    <app-team-select
      [teams]="teams_logos()"
      formControlName="team2"
      label="Team 2"
    ></app-team-select>

  </section>


  <div class="form-row timecode-row">
    <label>Time code</label>
    <div class="timecode">
      <mat-slider max="1" min="0" step="0.001">
        <input formControlName="timeCode" matSliderThumb>
      </mat-slider>
      <span>{{ (miniatureBuilderForm.get('timeCode')?.value)| number:'1.2-4' }}</span>
    </div>
    <small class="hint">Ajustez entre 0 et 1 (pas de 0.001).</small>
  </div>

  <!-- Sliders xOffset, yOffset, zoom sur une seule ligne -->

  <section class="builder-layout">

    <div class="left-pane">
      <div class="triple-sliders" formGroupName="viewport">

        <div class="slider-item">
          <label for="xOffset">xOffset
            <span class="value">{{ miniatureBuilderForm.get(['viewport', 'xOffset'])?.value ?? 0 }}</span>
          </label>
          <mat-slider id="xOffset" min="0" max="1" step="0.001">
            <input formControlName="xOffset" matSliderThumb>
          </mat-slider>
        </div>

        <div class="slider-item">
          <label for="yOffset">yOffset
            <span class="value">{{ miniatureBuilderForm.get(['viewport', 'yOffset'])?.value ?? 0 }}</span>
          </label>
          <mat-slider id="yOffset" min="0" max="1" step="0.001">
            <input formControlName="yOffset" matSliderThumb>
          </mat-slider>
        </div>

        <div class="slider-item">
          <label for="zoom">Zoom
            <span class="value">{{ (miniatureBuilderForm.get(['viewport', 'zoom'])?.value ?? 1) | number:'1.1-1' }}
              x</span>
          </label>
          <mat-slider id="zoom" min="1" max="5" step="0.01">
            <input formControlName="zoom" matSliderThumb>
          </mat-slider>
        </div>

      </div>

    </div>

    <div class="right-pane">
      <app-images-preview
        [baseImageUrl]="videoMetadata()?._links?.base_image?.href ?? ''"
        [miniatureUrl]="videoMetadata()?._links?.miniature_image?.href ?? ''"

        [xOffset]="miniatureBuilderForm.get(['viewport','xOffset'])?.value ?? 0"
        [yOffset]="miniatureBuilderForm.get(['viewport','yOffset'])?.value ?? 0"
        [zoom]="miniatureBuilderForm.get(['viewport','zoom'])?.value ?? 1"

        (xOffsetChange)="miniatureBuilderForm.get(['viewport','xOffset'])?.setValue($event)"
        (yOffsetChange)="miniatureBuilderForm.get(['viewport','yOffset'])?.setValue($event)"
        (zoomChange)="miniatureBuilderForm.get(['viewport','zoom'])?.setValue($event)">
      </app-images-preview>
    </div>
  </section>
</div>
