<section class="teams-row">
  <app-team-select
    (valueChange)="onTeamChange($event, 1)"
    [label]="'Team 1'"
    [teams]="teams_logos()"
    [value]="miniatureBuilderForm.value.team1??null">
  </app-team-select>

  <button (click)="onSwapTeams()" class="swap-btn" matButton="elevated">Swap teams</button>

  <app-team-select
    (valueChange)="onTeamChange($event,2)"
    [label]="'Team 2'"
    [teams]="teams_logos()"
    [value]="miniatureBuilderForm.value.team2??null">
  </app-team-select>
</section>


<div class="form-row timecode-row">
  <label>Time code</label>
  <div class="timecode">
    <mat-slider (input)="setControl('timeCode',$event)" max="1" min="0" step="0.001">
      <input
        [value]="miniatureBuilderForm.value.timeCode ?? 0"
        aria-label="Time code"

        class="slider"
        matSliderThumb
        type="range"

      /></mat-slider>

    <output class="timecode-value">{{ (miniatureBuilderForm.value.timeCode ?? 0) | number:'1.2-4' }}</output>
  </div>
  <small class="hint">Ajustez entre 0 et 1 (pas de 0.001).</small>
</div>

<!-- Sliders xOffset, yOffset, zoom sur une seule ligne -->
<section class="builder-layout">
  <div class="left-pane">
    <div class="triple-sliders">
      <div class="slider-item">
        <label>xOffset <span class="value">{{ miniatureBuilderForm.value.xOffset ?? 0 }}</span></label>
        <mat-slider (input)="setControl('xOffset',$event)" [max]="1" [min]="0" [step]="0.01">
          <input
            [value]="miniatureBuilderForm.value.xOffset ?? 0"
            aria-label="xOffset"
            matSliderThumb
            type="range"
          />
        </mat-slider>
      </div>

      <div class="slider-item">
        <label>yOffset <span class="value">{{ miniatureBuilderForm.value.yOffset ?? 0 }}</span></label>
        <mat-slider (input)="setControl('yOffset',$event)" [max]="1" [min]="0" [step]="0.01">
          <input
            [value]="miniatureBuilderForm.value.yOffset ?? 0"
            aria-label="yOffset"
            matSliderThumb
            type="range"
          />
        </mat-slider>
      </div>

      <div class="slider-item">
        <label>Zoom <span class="value">{{ (miniatureBuilderForm.value.zoom ?? 1) | number:'1.1-1' }}x</span></label>
        <mat-slider (input)="setControl('zoom',$event)" [max]="5" [min]="1" [step]="0.01">
          <input
            [value]="miniatureBuilderForm.value.zoom ?? 1"
            aria-label="Zoom"
            matSliderThumb
            type="range"
          />
        </mat-slider>
      </div>
    </div>
  </div>

  <div class="right-pane">
    @if (videoMetadata()?._links; as links) {
      <section>
        <app-images-preview
          [miniatureUrl]="links.miniature_image?.href ?? ''"
          [baseImageUrl]="links?.base_image?.href ?? ''"
          [xOffset]="miniatureBuilderForm.value.xOffset ?? 0"
          [yOffset]="miniatureBuilderForm.value.yOffset ?? 0"
          [zoom]="miniatureBuilderForm.value.zoom ?? 1"
          (xOffsetChange)="setControl('xOffset',$event)"
          (yOffsetChange)="setControl('yOffset',$event)"
          (zoomChange)="setControl('zoom',$event)"
        >
        </app-images-preview>
      </section>
    } @else {
      <section>
        <em>Chargement des images…</em>
      </section>
    }
  </div>

</section>


<div class="actions-row">
  <button (click)="onGenerateClick()" color="primary" mat-raised-button>
    Générer miniature
  </button>
</div>
